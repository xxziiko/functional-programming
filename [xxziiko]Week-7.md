# chapter 14.

- 객체에서 다룰 수 있는 함수형 도구
- 중첩된 구조에서 사용하는 함수형 도구

## 안전한 재귀 사용법

1. 종료 조건
    - 배열 인자가 비었거나, 점점 줄어 드는 값이 0이 되었거나, 찾아야 할 것이 더이상 없을 때
2. 재귀 호출
3. 종료 조건에 다가가기
    - 최소 하나 이상의 인자가 점점 줄어들어야 함.

## 깊이 중첩된 데이터에 추상화 벽 사용하기

- 깊이 중첩된 데이터를 사용할 때 너무 많은 것을 기억해야 하는 어려움 존재 → 추상화 벽에 함수를 만들고 의미 있는 이름을 붙여주기

## 지금까지 배운 고차 함수들

1. 배열을 반복할 때 `for`문 대신 사용하기
    - `forEach()`, `map()`, `filter()`, `reduce()`
2. 중첩된 데이터를 효율적으로 다루기
    - `update()`, `nestedUpdate()`
3. 카피-온-라이트 원칙 적용
4. `try/catch` 로깅 규칙을 코드화

## 요점 정리

- `update()`는 일반적인 패턴을 구현한 함수형 도구 → 객체에서 데이터 변경을 수동으로 하지 않게 해줌
- `nestedUpdate()`는 깊이 중첩된 데이터를 다루는 함수형 도구 → 바꾸려는 값과 키 경로를 알면 중첩된 데이터를 쉽게 바꿀 수 있음
- 중첩된 데이터를 다룰 때는 재귀가 더 쉽고 명확
- 재귀는 스스로 불렸던 곳이 어디인지 유지하기 위해 스택을 사용 → 재귀함수에서 스택은 중첩된 데이터 구조를 그대로 반영
- 깊이 중첩된 구조에 추상화 벽을 사용하자

# chapter 15.

### 타임라인 다이어그램

- 시간에 따른 액션 순서를 시각적으로 표시한 다이어그램
- 다이어그램 옆으로 타임라인을 하나씩 추가하면 각 액션이 서로 어떻게 상호작용하고 간섭하는 지 볼 수 있다.

## 타임라인 다이어그램 기본 규칙

1. 액션은 순서대로 실행되거나 동시에 실행된다.
2. 순서대로 실행되는 액션은 같은 타임라인에서 하나가 끝나면 다른 하나가 실행된다.
3. 동시에 실행되는 액션은 여러 타임라인에서 나란히 실행된다. 

## 액션 순서에 관한 두 가지 사실

1. `++` 와 `+=` 는 사실 세 단계
    
    ```jsx
    let temp = total //읽기(액션)
    temp = temp + 1; //더하기(계산)
    total = temp; // 쓰기(액션)
    ```
    
2. 인자는 함수를 부르기 전에 실행

### 비동기 호출은 새로운 타임라인으로 그린다.

## 스레드 모델

1. 단일 스레드, 동기
    - php
    - 모든것이 순서대로 실행되고 시스템이 단순
2. 단일 스레드, 비동기
    - js
    - 입출력의 결과는 콜백으로 받을 수 있지만, 언제 끝날 지 알 수 없기 때문에 다른 타임라인에 표현해야 한다.
3. 멀티 스레드
    - 자바, 파이썬, 루비, c, c# …
    - 실행순서를 보장하지 않기 때문에 프로그래밍하기 어려움
    - 새로운 스레드가 생기면 새로운 타임라인을 그려야 함
4. 메시지 패싱 프로세스

## 좋은 타임라인의 원칙

1. 타임라인은 적을 수록 이해하기 쉬움
2. 타임라인은 짧을 수록 이해하기 쉬움
3. 공유하는 자원이 적을수록 이해하기 쉬움
4. 자원을 공유한다면 서로 조율해야 함
5. 시간을 일급으로 다룸

## 타임라인 단순화하기

1. 하나의 타임라인에 있는 모든 액션을 하나로 통합
2. 타임라인이 끝나는 곳에서 새로운 타임라인이 하나 생긴다면 통합

## 자원을 공유하는 타임라인은 문제가 생길 수 있음

공유하는 자원을 없애 문제를 해결

1. 전역변수를 지역변수로 바꾸기
    1. 지역변수로 바꿀 수 있는 전역변수 찾기
    2. 찾은 전역변수를 지역변수로 바꿈
2. 전역변수를 인자로 바꾸기
    1. 암묵적 인자 확인
    2. 암묵적 입력을 인자로 바꾸기

## 비동기 호출에서 명시적인 출력을 위해 콜백을 사용한다

- 비동기 호출에서 결과를 받을 수 있는 방법은 콜백을 사용하는 것.
- 함수형 프로그래밍에서 액션을 빼낼 때 사용

## 요점 정리

- 타임라인은 동시에 실행될 수 있는 순차적 액션을 말함 → 코드가 순서대로 실행 되는지, 동시에 실행 되는지 구별 가능해짐
- 타임라인 다이어그램을 사용하면 코드가 순서대로 실행 되는지 동시에 실행 되는지 알 수 있음 → 서로 영향 받는 부분 파악
- 언어에서 지원하는 스레드 모델을 이해하는 것은 중요 → 타임라인에 대해 이해하는 것
- 자원을 공유하는 부분은 버그가 발생되기 쉬움 → 공유 자원을 없애면 코드가 더 좋아짐
- 자원을 공유하지 않는 타임라인은 독립적으로 이해하고 실행할 수 있음
